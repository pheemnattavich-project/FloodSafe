<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FloodSafe Report</title>
</head>
<body>

<h2>ЁЯУв р╣Бр╕Ир╣Йр╕Зр╣Ар╕лр╕Хр╕╕р╕ар╕▒р╕вр╕Юр╕┤р╕Ър╕▒р╕Хр╕┤</h2>

<input id="name" placeholder="р╕Кр╕╖р╣Ир╕н"><br><br>
<input id="phone" placeholder="р╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г"><br><br>
<input id="location" placeholder="р╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣И"><br><br>

<select id="helpType">
  <option value="">р╣Ар╕ер╕╖р╕нр╕Бр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н</option>
  <option value="р╕Щр╣Йр╕│р╕Чр╣Ир╕зр╕б">р╕Щр╣Йр╕│р╕Чр╣Ир╕зр╕б</option>
  <option value="р╕Фр╕┤р╕Щр╕Цр╕ер╣Ир╕б">р╕Фр╕┤р╕Щр╕Цр╕ер╣Ир╕б</option>
</select><br><br>

<textarea id="description" placeholder="р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б"></textarea><br><br>

<button onclick="send()">р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е</button>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyJjx7WWFFPP6R0akKxmsfxGSg4vOfAxRUJ8bpnHiQ198OPeDxm0vVHDMo_6ZEwAP95/exec";

let lat = "", lng = "";

navigator.geolocation.getCurrentPosition(
  pos => {
    lat = pos.coords.latitude;
    lng = pos.coords.longitude;
  },
  () => console.warn("р╣Др╕бр╣Ир╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╣Гр╕лр╣Йр╣Гр╕Кр╣Й GPS")
);

function send() {
  const payload = {
    name: document.getElementById("name").value.trim(),
    phone: document.getElementById("phone").value.trim(),
    location: document.getElementById("location").value.trim(),
    helpType: document.getElementById("helpType").value,
    description: document.getElementById("description").value.trim(),
    lat,
    lng
  };

  if (!payload.name || !payload.phone || !payload.location) {
    alert("р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╣Йр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ");
    return;
  }

  fetch(scriptURL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
  .then(res => res.text())
  .then(() => {
    alert("тЬЕ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з");
    document.querySelectorAll("input, textarea").forEach(el => el.value = "");
    document.getElementById("helpType").value = "";
  })
  .catch(() => alert("тЭМ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕бр╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И"));
}
</script>

</body>
</html>
